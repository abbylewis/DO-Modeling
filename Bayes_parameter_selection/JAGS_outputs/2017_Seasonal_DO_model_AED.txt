######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-6 on 2020-06-11 17:04:44 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 2:max(season_days)){
y[k,j] ~ dnorm(mu[k,j],tau_obs)
#process model for DO
mu[k,j]~dnorm(dO2dt[k,j],tau_proc) 
#lambda[k,j] <- ifelse(dO2dt[k,j]>0,dO2dt[k,j],0)
dO2dt[k,j] <- mu[k,j-1]+SSS[k,j-1]-R20*theta^(temp[k,j-1]-20)*mu[k,j-1]/(mu[k,j-1]+ko2)*ifelse(SSS[k,j]>0, sss_scalar,1)
}
#for(j in 1:max(season_days)){
#y[k,1] ~ dnorm(mu[k,1],tau_obs)
#}
#Loops through items in seasonal for-loop and defines initial conditions
mu[k,1] ~ dnorm(y[k,1],tau_ic)
#mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
#mu_S[k,1]~dnorm(x_S_ic,tau_S_ic) 
}
#### Priors
tau_proc ~ dgamma(k_proc,t_proc)
R20 ~ dnorm(beta.m_R20,beta.v_R20) 
theta ~ dnorm(beta.m_theta,beta.v_theta) 
ko2 ~ dlnorm(beta.m_ko2,beta.v_ko2) 
sss_scalar ~ dnorm(beta.m_sss_scalar,beta.v_sss_scalar)
tau_obs ~ dgamma(k_obs,t_obs)
#tau_S_obs ~ dgamma(0.01, 0.01) 
#tau_S_proc ~ dgamma(0.24, 300)
#tau_S_proc ~ dnorm(0,.01)
#calculations for gamma parameterized by mean (m) and standard deviation (sd)
#sh_proc <- pow(m_proc,2) / pow(sd_proc,2)
#ra_proc <- m_proc / pow(sd_proc,2)
#
#sh_obs <- pow(m_obs,2) / pow(sd_obs,2)
#ra_obs <- m_obs / pow(sd_obs,2)
}
#monitor# tau_proc, tau_obs, mu, R20, theta, ko2, sss_scalar

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(489, 1013654318, 610755163, -1681416450, 1000824193, 483616005, -392700625, 1364849196, -505335993, -952278623, -435636733, -880622635, 120992406, -435829219, -1631158417, 313139755, 1547246487, -2063562639, 391425594, -692442840, 677592945, -1058460446, -1394815697, 394035195, 1158980742, 1186787334, 1256081264, -1598338233, 1538926653, 1529754470, -1343356915, -1974449666, 1048916445, 14503360, -1457288589, -1142703228, 381503356, -396194550, -1429217663, 1337132382, 1971469408, 1770940949, -2019719782, 524220484, -511399320, 1675428315, 56864877, 1284265428, 2135800739, -985818453, -1191623470, -1932474429, -465567731, -722258756, -1487332603, 1174717636, -548051508, 693724016, -2031206579, -2029672059, -999142178, 553647691, -176843414, -542853383, 1634914934, -1833204421, 1649348022, 637743142, -1112846207, 1185426742, -1423773159, 1612460490, -1077010416, -1144287792, -884887969, -2139907225, 1310668287, -613538576, 900179321, -1336752687, -1241752147, -622840243, -1846747631, 115111954, 971931909, -1362897902, -2020259468, 1606337062, 970872309, -200550429, 1953150924, 1677097013, 110673319, -903587591, 2079437938, -1303665193, -1307155544, 1945117942, -1579117917, 1812040561, 585116339, -255939040, 739204154, 1991662851, -1522511316, -128412086, 70447665, 884926485, 58975266, -664411464, 2059880046, 210183797, -1439138984, 1420255229, -1288758368, -1127389431, -1739144398, -2015489066, -1922818285, 504576170, 33096512, 1368500798, -1570537050, 1574014450, -1070045984, -814231435, -320051833, 1949092807, -303668771, 479750810, -378504306, 1481524719, -1969444001, 342656031, 706684319, 1053814890, 920539028, -2041160621, 1440854708, 1797782685, -1090678667, 461697052, -844552715, -1285350605, -654795134, 1701403625, 446664615, 920964105, -964947088, -1876725792, -1648496560, -626977228, -1685758603, 341620098, 223694715, 1681984536, -537229879, -1394060160, -191183001, 1806917000, -873228808, 996503370, -976985209, 2093484553, -1837013744, 2137850004, 1480618533, 2112460116, -1821185286, -692192519, -1628727496, -385014436, 624004349, 1058150858, -2044183830, 1360101354, 214750902, -613172662, 1175004123, 1002424793, 1502176619, 1971406856, -1994246396, 103595616, -102908608, 1838765453, -547940532, -1212116776, -1626537364, 747524465, 2115592127, 1366375102, 352570630, 499918750, 2070218457, -1947400035, -1834063972, -1144293927, 1394817582, 1775278096, 1550110360, 1889250685, 134270657, 1119949420, -132858442, 126239356, -214438372, 1919523911, 1329551524, 32725315, -34409616, 2075589560, 1149079603, -454819217, -502250704, -962455212, -936652339, 963541936, -1632808385, -90923204, 1455218554, 950049068, -926940722, -1792791591, 762201954, -345741576, -860139687, 1564678920, -1948427734, -1667010954, 1858965229, -783575425, 239821827, 956846663, 380412979, -385021115, 2124651219, 2087257429, -1231188802, 1316399852, 332972462, -204544788, -834373308, -434476953, 1245505483, -754627767, 1922573379, -2094882921, 781811275, -1503626184, 717603088, 1613810535, -1745016438, -1411153466, -270460471, 1914075160, -469332329, 2036947797, 974293196, 1926654469, 783162948, 1621805353, 1568154294, -101892142, 194209500, -880800276, -878398850, -1554146383, -1782531600, 1245467203, 893390873, 1011116272, 1713575641, 135803255, 254925073, 1764762943, 325201858, -92874318, -1740207987, -108110112, 1296589427, 144575671, 629582416, 1571356151, 2113918377, 592759005, 1296015204, 974725736, 587120136, 143334679, -159987070, 1189629002, -1482968505, 482798885, -1371990202, 1888659172, -1132702252, 1565577066, -434752103, 1215719140, 243234602, 1658612286, 1743789323, 1297968631, -1378324371, -344352214, 1390215864, -2675916, 771547169, 1512287164, -1289605564, -2064663216, -1967570565, 945845712, 1438104508, 2062384915, -1912822990, 775647621, 418084766, -1493676263, 1500585280, 1099552910, 1561740728, 704595816, 1453937528, 1052246489, -1419092770, 191939244, -1968830617, -1477380560, -1250476678, 939048992, 739119423, 2099148578, -1250583696, 332347366, -1276144233, 899096070, 2087729000, -1894040583, 686302122, -1671946410, 454300465, 638983636, -1204181616, -91598563, 1641052687, 713968445, -1617265857, 2001511419, -1333528875, -2141767308, -499654934, 2063165078, -945820932, -358181545, 1518796590, -2016829586, 2017212557, -696684453, 1559156942, 493066527, 936836230, -443920070, 6568922, -306611327, 450065859, -177006674, -2042514811, -172540415, 1488607911, -230138290, -1243250135, 475830041, -280416685, 333871356, -628137380, 1447327990, 1923266953, -1342092399, 58719097, 619363528, 1737723813, -353797708, -586036392, -1371777815, -439491569, -1980979382, -1642947525, -1202245576, -485498002, 1462052208, 728385783, -1641080398, 532400918, -1333707931, -2007504025, 1157826606, -959008257, 688751739, -954987053, 1548747523, 2033320934, 943599589, -2004053092, 388421145, -1041889859, 678269107, -288747259, -881116242, 1653109800, -581750455, 1613813394, -663762636, 954288540, -1732998682, -437422725, 1996105705, 251125747, -1780131105, -205196206, 560084696, -1944788470, -34465490, -601279998, 860879054, 948880759, -375118902, 871188728, -1493664624, 518579418, -2013852099, -22181941, -515508190, 1231406729, -83505821, -2031541175, -1262449968, 1013210661, 697373789, 807021995, -1881818924, 32842655, -1702233026, 1727483107, -779112160, -1268053633, 916364519, 1714744662, -313758050, 132696629, -150207841, 2042131912, 929094106, -735608251, -192286093, 704858584, -37758855, -1355546805, 1886592858, 1839855128, -1575982375, -1938675920, -2072592017, 960161819, 498469919, -842211106, 618044923, -1423697757, 2015073458, 785294404, 970162843, -1347865827, -317506257, -1772647002, -2093033430, -1522896559, -1931847178, -1269968206, 840489421, 1823123261, 529454919, 1183632198, -1172835430, -1503073176, -415508558, -1724041549, 754414008, 590121364, -365402338, 111842998, 1065289046, 226086068, -745388227, -1908236626, 1882510610, 970150493, 1104742413, 1062431496, 717420694, -177662922, -771159473, -919806, -1154975318, 531299289, 746479934, -45527474, 671613054, -1402318373, 1997517359, 209745697, 802202955, 901783923, 143317887, -1125913862, -1623281103, -1536745532, -1458646546, 1603979578, -491586239, -1497425824, -738225875, 1303765402, -421161506, 1405966498, 85065862, -1302362140, -1651446166, -1958216767, -266072423, -162792316, -1312454890, 1993313845, -1592439337, -1629786157, 1496268585, 1059984688, 610262958, -1062215991, 2014843773, 829162688, -1422509992, -1508054355, 1270914344, -1021577690, -1867764587, -1838115899, 2125340076, -963724234, 945616929, 394814477, -1872644465, 1833893599, -1984026780, -146197023, 257296274, 1493761329, -505786851, 596326498, 1425174203, -19613504, 506385384, 729246163, 57247576, -394483685, 519264124, 1279604531, 1274258805, 1444777306, 338048608, 1953894171, 234960573, 824778695, 1216629581, 703655082, 1028863615, -1361685981, -564555315, -94403652, 1895565433, 801855546, 1468508344, 1337439715, 8616055, -1578714907, -1893281137, -43758157, 800448122, -543721266, 264350783, -907100309, -1069639114, -66976360, -1299326815, 1108833612, 9007599, 1242965810, 1007114629, 186555659, 3147592, -1422377222, -844519981, 1833951353, -633042854, 1180076187, 1371616707, -32573886, 1840498477, 1804939703, -1286097771, 317488109, -92752827, 1129711466, -1363592466, -584199690, -720758560, -1718609199, -392050518, 886208904, -1074572033, 612572488, 1150170722, -291820283, 9225240, 456563129)
"R20" <- 0.679033928093742
"ko2" <- 1.51791385142478
"mu" <- structure(c(9.39507539390798, 8.05694944482414, 8.91595442093001, 7.38683534703975, 7.43136282739117, 7.64898507787244, 8.44939329803885, 8.10481339230598, 7.64994122937143, 7.66118478425192, 8.33193064011183, 6.56712884450412, 7.1873424998406, 8.08834642491063, 8.2616233795996), .Dim = c(1, 15))
"sss_scalar" <- 1.60504733819159
"tau_obs" <- 0.771819365867049
"tau_proc" <- 0.696989939727007
"theta" <- 1.06101361632516
"y" <- structure(c(NA, 9.19593142448726, 9.10418630051932, 9.01070423152913, 8.91548910066039, 8.81854516197487, NA, 8.61948988177891, 8.51827968480981, 8.41625295225939, 8.31341649345835, NA, NA, NA, NA), .Dim = c(1, 15))
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(28052, 27508, 9658)
"R20" <- 0.498532475094364
"ko2" <- 0.992483948926884
"mu" <- structure(c(9.08286385004403, 9.24197981893198, 9.47703465898261, 10.9568499356883, 10.4957029423799, 9.5325694504845, 8.71207989498597, 8.2010893552353, 9.07709623282486, 8.59880570939802, 8.61119220058222, 8.69382501796722, 8.94289020037528, 8.51325352335713, 7.39101873510285), .Dim = c(1, 15))
"sss_scalar" <- 1.78377898093682
"tau_obs" <- 0.568721159390821
"tau_proc" <- 1.99352436692824
"theta" <- 1.06695593598326
"y" <- structure(c(NA, 9.19593142448726, 9.10418630051932, 9.01070423152913, 8.91548910066039, 8.81854516197487, NA, 8.61948988177891, 8.51827968480981, 8.41625295225939, 8.31341649345835, NA, NA, NA, NA), .Dim = c(1, 15))
".RNG.name" <- "base::Wichmann-Hill"
}

inits{
".RNG.state" <- c(110949083, 688849803)
"R20" <- 0.613224489148339
"ko2" <- 1.19718549986935
"mu" <- structure(c(9.53076515934775, 9.52127891172576, 7.3413098953314, 9.39693847919256, 8.87122672591593, 7.82266707377549, 9.9336033099904, 10.8196586332559, 8.28630237986527, 10.7412919169318, 9.71651214764513, 8.98869081115417, 8.99982429530266, 8.78156659137119, 5.9132021682553), .Dim = c(1, 15))
"sss_scalar" <- 3.08190596192412
"tau_obs" <- 0.0958554856017848
"tau_proc" <- 0.269845212933777
"theta" <- 1.07177810686232
"y" <- structure(c(NA, 9.19593142448726, 9.10418630051932, 9.01070423152913, 8.91548910066039, 8.81854516197487, NA, 8.61948988177891, 8.51827968480981, 8.41625295225939, 8.31341649345835, NA, NA, NA, NA), .Dim = c(1, 15))
".RNG.name" <- "base::Marsaglia-Multicarry"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(9.28593606835414, NA, NA, NA, NA, NA, 9.10333943935555, NA, NA, NA, NA, 8.74405354355872, 8.49970675944082, 8.00649266909527, 7.66421795924665), .Dim = c(1, 15))
"year_no" <- 1
"beta.m_R20" <- 0.7
"beta.m_theta" <- 1.08
"beta.m_ko2" <- 0.2
"beta.m_sss_scalar" <- 2.2
"beta.v_R20" <- 100
"beta.v_theta" <- 5000
"beta.v_ko2" <- 50
"beta.v_sss_scalar" <- 4
"SSS" <- structure(c(0.772084052511245, 0.772084052511245, 0.772084052511245, 0.772084052511245, 0.772084052511245, 0.772084052511245, 0.772084052511245, 0.772084052511245, 0.772084052511245, 0.772084052511245, 0.772084052511245, 0.772084052511245, 0.772084052511245, 0.772084052511245, 0.772084052511245), .Dim = c(1, 15))
"temp" <- structure(c(12.7382706530147, 12.7671581398067, 12.7960456265987, 12.8249331133907, 12.8538206001827, 12.8827080869747, 12.9115955737667, 12.9272394778789, 12.9428833819911, 12.9585272861034, 12.9741711902156, 12.9898150943278, 13.0543713926834, 13.1331018386651, 13.2042068342291), .Dim = c(1, 15))
"season_days" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15)
"tau_ic" <- 100
"k_proc" <- 0.2
"t_proc" <- 1
"k_obs" <- 0.1
"t_obs" <- 1


}

######################################################################################################
######################################################################################################
